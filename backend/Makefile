# Makefile pour SPIGNOS

VENV=.venv/bin
MANAGE=python manage.py

# === MAKEFILE - SPIGNOS DJANGO BACKEND ===

.PHONY: help install migrate run swagger swagger-json clean clean-pyc

# ðŸ”¹ Aide
help:
	@echo "ðŸš€ Commandes disponibles :"
	@echo "  make install        # Installe les dÃ©pendances"
	@echo "  make migrate        # GÃ¨re les migrations Django"
	@echo "  make run            # Lance le serveur Django"
	@echo "  make swagger        # GÃ©nÃ¨re Swagger YAML + JSON"
	@echo "  make swagger-json   # GÃ©nÃ¨re uniquement Swagger JSON"
	@echo "  make clean-pyc      # Supprime les .pyc et __pycache__"

# ðŸ”¹ Installation des dÃ©pendances
install:
	pip install -r requirements.txt

# ðŸ”¹ Migrations Django
migrate:
	python manage.py makemigrations
	python manage.py migrate

# ðŸ”¹ Lancement du serveur Django
run:
	@echo "ðŸš€ Lancement du serveur Django..."
	python manage.py runserver

# ðŸ”¹ GÃ©nÃ©ration Swagger YAML + JSON
swagger:
	python manage.py spectacular --file schema.yaml
	python manage.py spectacular --file schema.json

# ðŸ”¹ GÃ©nÃ©ration Swagger JSON uniquement
swagger-json:
	python manage.py spectacular --file schema.json

# ðŸ”¹ Nettoyage des fichiers Python compilÃ©s
clean-pyc:
	find . -type f -name '*.pyc' -delete
	find . -type d -name '__pycache__' -exec rm -r {} +
